<%- include("../_header") -%> <%- include("../_backend") -%>

<div x-data="{isSettingsOpen: false}">
  <header class="bg-white shadow">
    <div class="container flex justify-between items-center">
      <h1 class="text-xl font-bold leading-tight text-gray-900">
        <%= project.name %>
      </h1>
      <button class="btn-secondary" @click="isSettingsOpen = !isSettingsOpen">
        Settings
      </button>
    </div>
  </header>

  <main>
    <div class="container">
      <div class="bg-white rounded shadow-md">
        <div class="py-4 px-4 lg:flex lg:items-center lg:justify-between">
          <p class="text-sm">
            If you have changed the structure of the Google Sheet click on sync
            to update.
          </p>
          <div class="mt-8 flex lg:flex-shrink-0 lg:mt-0">
            <div class="inline-flex rounded-md shadow">
              <a href="/projects/<%= project._id %>/sync" class="btn-primary">
                Sync
              </a>
            </div>
          </div>
        </div>
      </div>
      <% if(project.endpoints) { %>
      <div class="bg-white rounded shadow-md mt-6 py-4 px-4">
        <h2 class="text-xl pt-2 pb-4">
          <%=project.endpoints.length%> endpoint(s)
        </h2>
        <% project.endpoints.forEach(endpoint => { %>
        <div class="mb-2">
          <div class="bg-gray-800 text-white px-4 py-2 rounded-t font-bold">
            <%= endpoint.name %>
          </div>
          <div class="border px-4 py-3 text-teal-800 rounded-b">
            <a
              href="/projects/<%= project._id %>/json/<%= endpoint.slug %>"
              target="_blank"
              >/projects/<%= project._id %>/json/<%= endpoint.slug %></a
            >
          </div>
        </div>
        <% }); %>
      </div>
      <% } else { %>
      <p class="text-center text-xl py-6 leading-relaxed text-gray-700">
        You don't have any endpoint. <br />Add tabs to the table and click sync.
      </p>
      <% } %>
    </div>
  </main>

  <div
    x-show="isSettingsOpen"
    class="fixed bottom-0 inset-x-0 px-4 pb-4 sm:inset-0 sm:flex sm:items-center sm:justify-center"
  >
    <!--
      Background overlay, show/hide based on modal state.
  
      Entering: "ease-out duration-300"
        From: "opacity-0"
        To: "opacity-100"
      Leaving: "ease-in duration-200"
        From: "opacity-100"
        To: "opacity-0"
    -->
    <div
      x-show="isSettingsOpen"
      x-transition:enter="ease-out duration-300"
      x-transition:enter-start="opacity-0"
      x-transition:enter-end="opacity-100"
      x-transition:leave="ease-in duration-200"
      x-transition:leave-start="opacity-100"
      x-transition:leave-end="opacity-0"
      class="fixed inset-0 transition-opacity"
    >
      <div class="absolute inset-0 bg-gray-500 opacity-75"></div>
    </div>

    <!--
      Modal panel, show/hide based on modal state.
  
      Entering: "ease-out duration-300"
        From: "opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"
        To: "opacity-100 translate-y-0 sm:scale-100"
      Leaving: "ease-in duration-200"
        From: "opacity-100 translate-y-0 sm:scale-100"
        To: "opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"
    -->
    <div
      x-show="isSettingsOpen"
      x-transition:enter="ease-out duration-300"
      x-transition:enter-start="opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"
      x-transition:enter-end="opacity-100 translate-y-0 sm:scale-100"
      x-transition:leave="ease-in duration-200"
      x-transition:leave-start="opacity-100 translate-y-0 sm:scale-100"
      x-transition:leave-end="opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"
      class="bg-white rounded-lg overflow-hidden shadow-xl transform transition-all sm:max-w-lg sm:w-full"
      role="dialog"
      aria-modal="true"
      aria-labelledby="modal-headline"
    >
      <div class="bg-white px-4 pt-4 pb-4 sm:p-6 sm:pb-4">
        <div class="bg-red-100 border border-red-200 rounded px-4 py-3">
          <h3 class="font-bold">Danger zone</h3>
          <p class="text-sm text-gray-600">
            The suppression of a project is an irreversible operation.
          </p>
          <a
            href="/projects/<%=project._id%>/delete"
            class="inline-block btn bg-red-600 text-white mt-4"
            >Delete project</a
          >
        </div>
      </div>
      <div class="bg-gray-100 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
        <span class="mt-3 flex w-full rounded-md shadow-sm sm:mt-0 sm:w-auto">
          <button
            type="button"
            @click="isSettingsOpen = !isSettingsOpen"
            class="inline-flex justify-center w-full btn-secondary"
          >
            Close
          </button>
        </span>
      </div>
    </div>
  </div>
</div>

<%- include("../_footer") -%>
